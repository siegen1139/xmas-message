<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>3段スライド背景 Ver.15.1.2</title>

<style>
html, body {
  margin: 0;
  padding: 0;
}

body {
  padding: 20px;
}

/* 背景全体 */
.bg {
  position: fixed;
  inset: 0;
  z-index: -1;
  background-color: #6b76ae;
  pointer-events: none;
  overflow: hidden;

  --row-height: 33.333vh;
}

/* 各段 */
.row {
  position: absolute;
  left: 0;
  right: 0;
  height: var(--row-height);
  overflow: hidden;
}

.row1 { top: 0; }
.row2 { top: var(--row-height); }
.row3 { top: calc(var(--row-height) * 2); }

/* ベルト（段いっぱいの高さ） */
.belt {
  display: flex;
  align-items: center;
  height: 100%;
  will-change: transform;
}

/* ★ 2段目のみ右詰め */
.row2 .belt {
  justify-content: flex-end;
}

/* 画像サイズ統一 */
.belt img {
  height: 99%;      /* 各段の99% */
  width: auto;      /* 縦横比維持 */
  display: block;
  object-fit: contain;
}

main {
  position: relative;
  z-index: 1;
}
</style>
</head>

<body>

<div class="bg" aria-hidden="true">

  <!-- 1段目（左へ） -->
  <div class="row row1">
    <div class="belt js-loop" data-dir="left">
      <img src="assets/row1/1.png">
      <img src="assets/row1/2.png">
      <img src="assets/row1/3.png">
      <img src="assets/row1/4.png">
      <img src="assets/row1/5.png">
    </div>
  </div>

  <!-- 2段目（右へ・右詰め） -->
  <div class="row row2">
    <div class="belt js-loop" data-dir="right">
      <img src="assets/row2/6.png">
      <img src="assets/row2/7.png">
      <img src="assets/row2/8.png">
      <img src="assets/row2/9.png">
      <img src="assets/row2/10.png">
    </div>
  </div>

  <!-- 3段目（左へ） -->
  <div class="row row3">
    <div class="belt js-loop" data-dir="left">
      <img src="assets/row3/11.png">
      <img src="assets/row3/12.png">
      <img src="assets/row3/13.png">
      <img src="assets/row3/14.png">
      <img src="assets/row3/15.png">
    </div>
  </div>

</div>

<main>
  <h1>メッセージ Ver.15.1.2</h1>
  <p>各段の高さ99%で画像サイズ統一</p>
</main>

<script>
document.querySelectorAll('.js-loop').forEach(belt => {
  const dir = belt.dataset.dir === 'right' ? 1 : -1;
  const duration = 40000;

  belt.innerHTML += belt.innerHTML;

  let baseWidth;

  const update = () => {
    baseWidth = belt.scrollWidth / 2;
  };

  window.addEventListener('resize', update);
  update();

  const loop = () => {
    const t = (performance.now() / duration) % 1;
    const offset = t * baseWidth;

    if (dir === -1) {
      belt.style.transform = `translateX(${-offset}px)`;
    } else {
      belt.style.transform = `translateX(${-(baseWidth - offset)}px)`;
    }

    requestAnimationFrame(loop);
  };

  loop();
});
</script>

</body>
</html>
